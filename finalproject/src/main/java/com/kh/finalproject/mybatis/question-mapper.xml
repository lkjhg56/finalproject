<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
 
 <mapper namespace="question">
 	<select id="sequence" resultType="int">
 		select question_seq.nextval from dual
 	</select>
 	 <select id="userSequence" resultType="int">
 		select user_custom_question_seq.nextval from dual
 	</select>
 	<!-- 
 	문제 업로드
 	* 관리자만 question_premium 변경 가능하도록 해야함.
 	* user_custom_question 테이블도 같이 변해야 함.
 	 -->
 	<insert id="upload" parameterType="uploadQuestionDto">
 		insert into question values(
 			#{question_no},
 			#{user_custom_question_no},
 			#{question_title},
 			#{question_content},
 			#{question_answer},
 			#{question_solution},
 			0,
 			#{answer1},
 			#{answer2},
 			#{answer3},
 			#{answer4},
 			#{answer5}
 			)
 	</insert>
 	<insert id="upload_sub" parameterType="uploadQuestionDto">
 		insert into user_custom_question values(
 			#{user_custom_question_no},
 			#{user_no},
 			#{category_name}
 		)
 	</insert>
 	<insert id="upload_file" parameterType="uploadQuestionDto">
 		insert into question_file values(
 		question_file_seq.nextval,
		#{file_upload_name},
		#{file_save_name},
		#{file_type},
		#{file_size},
		#{question_no}
 		)
 	</insert>
 	<!-- 
 	문제 수정
 	* 관리자만 question_premium 변경 가능하도록 해야함.
 	 -->
 	<update id="update" parameterType="uploadQuestionDto">
 		update question set 
 			question_title=#{question_title},
 			question_content=#{question_content},
 			question_answer=#{question_answer},
 			question_solution=#{question_solution},
 			question_premium=#{question_premium} 
 		where question_no=#{question_no}			
 	</update>
 	<!-- 
 	문제 조회
 	* 전체 조회
 	 --> 	
 	 <select id="getList" resultType="uploadQuestionDto">
 	 	select * from question order by question_no asc
 	 </select>
 	 
 	 <!-- 세션 id를 이용하여 user_no를 가져옴 -->
 	 <select id="getNo" parameterType="String" resultType="int">
 	 	select user_no from users where id=#{id}
 	 </select>
 </mapper>
